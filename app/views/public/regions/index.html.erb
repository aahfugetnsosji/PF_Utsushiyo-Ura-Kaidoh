<div class="container">
  <div class="row">
    <div class="col">
      <h1>地方区分絞り込み結果一覧</h1>
      <span>
        全<%= @posts.count %>件
      </span>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
      <!--キーワード検索窓-->
      <div class="row">
        <%= form_tag search_path, method: :get do %>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>キーワード検索</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <%= text_field_tag :keyword %><br>
                  <%= submit_tag '検索', :body => nil %>
                </td>
              </tr>
            </tbody>
          </table>
        <% end %>
      </div>

      <!--タグ検索窓-->
      <div class="row">
        <%= form_tag posts_path, method: :get do %>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>タグ検索</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <%= select_tag :tag_id, options_from_collection_for_select(@tags, :id, :name, params[:tag_id]), { prompt: "--選択してください--" } %><br>
                  <%= submit_tag '検索' %>
                </td>
              </tr>
            </tbody>
          </table>
        <% end %>
      </div>

      <!--地方区分検索窓-->
      <div class="row">
        <%= form_tag regions_path, method: :get do %>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>地方区分で絞り込み</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <%= select_tag :region_id, options_from_collection_for_select(@regions, :id, :region_name, params[:region_id]), { prompt: "--選択してください--" } %><br>
                  <%= submit_tag '検索' %>
                </td>
              </tr>
            </tbody>
          </table>
        <% end %>
      </div>

      <!--都道府県検索窓-->
      <div class="row">
        <%= form_tag prefectures_path, method: :get do %>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>都道府県で絞り込み</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <%= select_tag :prefecture_id, options_from_collection_for_select(@prefectures, :id, :prefecture_name, params[:prefecture_id]), { prompt: "--選択してください--" } %><br>
                  <%= submit_tag '検索' %>
                </td>
              </tr>
            </tbody>
          </table>
        <% end %>
      </div>
    </div>

    <div class="col-md-8">
      <% if @posts.count == 0 %>
        <div>
          <p>
            投稿はありません。
          </p>
        </div>
      <% else %>
        <div class="card-deck">
        <% @posts.each do |post| %>
          <a href="/posts/<%= post.id %>" class="card text-dark border-dark" style="width: 20%;">
            <%= image_tag post.get_image(200, 200), class: "card-img-top" %>
            <div class="card-body">
              <h6 class="card-title">
                <%= post.title %>
              </h6>
              <p class="card-text">
                <%= safe_join(post.body.split("\n"),tag(:br)) %>
              </p>
              <p class="card-text">
                <%= post.user.name %>
                <%= l post.created_at, format: :short %>
              </p>
            </div>
          </a>
        <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>